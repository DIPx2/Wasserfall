--------------------------------------------------------------
## Версия 1.00.000

Каталог REINDEX содержит набор PL/pgSQL-скриптов для развёртывания регламента реиндексации в комплексном обслуживания баз данных с учетом автоматизации задач; автоматизация выполняется с учетом наличия сервера автоматизации.
Скрипты предназначены для работы с минимизацией влияния на производительность рабочих систем благодаря использованию CONCURRENTLY, без остановки системы.

Работает с b-tree-индексами.

Написаны для PostgreSQL 17.4

Алгоритм поиска раздутых индексов взят с... (дай бог здоровья тому кто его написал), из всех найденных и проаналированных является самы точным
- произведена корректировка скрипта в операциях деления для устранения иногда возникающей ошибки деления на 0.

Типичный сценарий развертывания: следование порядковому номеру в именах файлов.

Надлежит вручную анализировать журнальную информацию.

Планы на следующие версии:
1) С учетом того, что базовая версия предназначена кроме основной задачи в том числе и для сбора статистической ифнормации, не производится очистка журналов:
	1.1) дополнить алгоритм: удалять устаревшие записи;
2) Использовать статистическую информацию для:
	2.1) нахождения индексов, не устранившие раздутость для их последующего анализа причин;
		2.1.1) На основании анализа, произвести модернизацию алгоритма для полного устранения раздутости;
	2.2) оптимизации графика процесса реиндексации;
3) Произвести интеграцию с Zabbix.

Алгоритм поиска раздутых индексов ("reindex_get_bloated_indexes.sql") использует следующую математику:

%разбухания = 100 * ( ( КоличествоСтраниц - РасчетноеКоличествоСтраниц ) / КоличествоСтраниц )
где
РасчетноеКоличествоСтраниц = ( 4 + РазмерОднойЗаписи * КоличествоЗаписей) / 8152
где
8152 = РазмерСтраницы (8192) - ЗагловокСтраницы (24) - СпецПространствоИндекса (16)
4 = РазмерУказателяЗаписи
РазмерОднойЗаписи = ЧётноеВыравнивание + РазмерДанныхСтраницы
где
ЧётноеВыравнивание = ( 8 - ( РазмерДанных mod 8 ) )
где
8 = ВыравнивающееСмещениеX64битныхСистем

--------------------------------------------------------------
## Версия 1.00.001

Переменная входящая bloat_ratio_search переписывалась объявленной переменной.

--------------------------------------------------------------