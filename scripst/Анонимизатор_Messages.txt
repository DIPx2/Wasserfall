	--======================
---- messages
	--=====================

--SELECT id,  MAX(LENGTH(msg)) from messages where msg is not null and msg not like '%{%' and msg != '' group by id limit 1000

SELECT msg from messages where msg is not null and msg not like '%{%' and msg != '' and length(msg) between 1000 and 12597 -- 483 записи
SELECT msg from messages where msg is not null and msg not like '%{%' and msg != '' and length(msg) between 2000 and 12597 -- 37 записей
SELECT msg from messages where msg is not null and msg not like '%{%' and msg != '' and length(msg) between 3000 and 12597 -- 9 записей
SELECT msg from messages where msg is not null and msg not like '%{%' and msg != '' and length(msg) between 4000 and 12597 -- 4 записи
SELECT msg from messages where msg is not null and msg not like '%{%' and msg != '' and length(msg) = 12597 -- 1 запись



SELECT 
    information_schema.columns.table_name,
    information_schema.columns.column_name
FROM 
    information_schema.columns
JOIN 
    information_schema.tables 
    USING (table_schema, table_name)
WHERE 
    information_schema.columns.data_type = 'character varying'AND
	information_schema.tables.table_type = 'BASE TABLE' AND 
	information_schema.columns.table_schema = 'public' AND
	information_schema.columns.table_catalog = 'mbss_master'
ORDER BY 
    information_schema.columns.table_name, 
    information_schema.columns.column_name;
	
	
	
	SELECT *
FROM messages
WHERE msg !~ '^\s*{.*}$'; -- Regex to detect invalid JSON-like structure